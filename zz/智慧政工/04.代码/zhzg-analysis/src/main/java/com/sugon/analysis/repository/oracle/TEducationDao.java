package com.sugon.analysis.repository.oracle;import com.sugon.analysis.domain.data.object.oracle.TEducationDo;import org.springframework.data.jpa.repository.JpaRepository;import org.springframework.data.jpa.repository.Query;import java.util.List;/** * @author: create by huangxb * @version: v1.0 * @description: * @date:2019/10/10 */public interface TEducationDao extends JpaRepository<TEducationDo, Long> {    /**     * 查询所有人的最高学历     * @param idNo     * @param delStatus     * @return     */    @Query(value = "SELECT * FROM (SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,NJGAZNL.T_EDUCATION_INFO.* FROM NJGAZNL.T_EDUCATION_INFO) WHERE rn = 1 AND IDNO IN (?1) AND DELSTATUS =?2", nativeQuery = true)    List<TEducationDo> getFirstByIdNo(List<String> idNo , String delStatus);    /**     * 查询某个人的最高学历     * @param idNo     * @param delStatus     * @return     */    @Query(value = "SELECT * FROM (SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,NJGAZNL.T_EDUCATION_INFO.* FROM NJGAZNL.T_EDUCATION_INFO) WHERE rn = 1 AND IDNO =?1 AND DELSTATUS =?2", nativeQuery = true)    TEducationDo getFirst(String idNo ,String delStatus);    @Query(value = " select * from(SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,NJGAZNL.T_EDUCATION_INFO.* FROM NJGAZNL.T_EDUCATION_INFO where idno in(select idNo from NJGAZNL.T_person where source in(?1) and delstatus = '0')) where rn  = '1' and (law_mark = '1' or law_mark = '1003')", nativeQuery = true)    List<TEducationDo> getAllByByPolice(List<String> source);    @Query(value = " select * from(SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,NJGAZNL.T_EDUCATION_INFO.* FROM NJGAZNL.T_EDUCATION_INFO where idno in(select idNo from NJGAZNL.T_person where source in(?1) and delstatus = '0')) where rn  = '1' and law_mark not in ('1','1003')", nativeQuery = true)    List<TEducationDo> getAllByBySocial(List<String> source);    @Query(value = "select idNo from(SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,NJGAZNL.T_EDUCATION_INFO.* FROM NJGAZNL.T_EDUCATION_INFO where idno in(select idNo from NJGAZNL.T_person where source in(?1) and idNo in(?2) and delstatus = '0')) where rn  = '1' and (law_mark = '1' or law_mark = '1003')", nativeQuery = true)    List<String> getAllByByPoliceAndIdNo(List<String> source,List<String> idNos);    @Query(value = " select idNo from(SELECT ROW_NUMBER() OVER(PARTITION BY IDNO ORDER BY TO_NUMBER(SUBSTR(DATA_SOURCE_ID,12,13)) DESC) rn,nvl(NJGAZNL.T_EDUCATION_INFO.law_mark,'-1') AS law_mark,idNo FROM NJGAZNL.T_EDUCATION_INFO where idno in(select idNo from NJGAZNL.T_person where source in(?1) and idNo in(?2) and delstatus = '0')) where rn  = '1' and law_mark not in ('1','1003')", nativeQuery = true)    List<String> getAllByBySocialAndIdNo(List<String> source,List<String> idNos);}